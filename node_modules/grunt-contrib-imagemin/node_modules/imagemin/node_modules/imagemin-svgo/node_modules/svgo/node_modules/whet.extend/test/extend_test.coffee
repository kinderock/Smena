###
Test suite for node AND browser in one file
So, we are need some data from global
Its so wrong, but its OK for test
###
# resolve require from [window] or by require() 
# _ = @_ ? require 'lodash'

lib_path = GLOBAL?.lib_path || ''

extend = require "#{lib_path}whet.extend"

describe 'whet.extend:', ->

  str = int = arr = date = obj = deep = null

  beforeEach ->
    str  = 'me a test'
    int  = 10
    arr  = [ 1, 'what', new Date( 81, 8, 4 )];
    date = new Date( 81, 4, 13 );

    obj = 
      str : str
      int : int
      arr : arr
      date : date

    deep = 
      ori : obj
      layer : 
        int : 10
        str : 'str'
        date : new Date( 84, 5, 12 )
        arr : [ 101, 'dude', new Date( 82, 10, 4 )]
        deep : 
          str : obj.str
          int : int
          arr : obj.arr
          date : new Date( 81, 7, 4 )
    
  describe 'should merge string with:', ->

    it 'string', ->
      ori    = 'what u gonna say';
      target = extend ori, str

      ori.should.eql 'what u gonna say'
      str.should.eql 'me a test'
      target.should.eql
        '0' : 'm',
        '1' : 'e',
        '2' : ' ',
        '3' : 'a',
        '4' : ' ',
        '5' : 't',
        '6' : 'e',
        '7' : 's',
        '8' : 't'

    it 'number', ->
      ori    = 'what u gonna say'
      target = extend ori, int

      ori.should.eql 'what u gonna say'
      int.should.eql 10 
      target.should.eql {}

    it 'array', ->
      ori    = 'what u gonna say'
      target = extend ori, arr 

      ori.should.eql 'what u gonna say'
      arr.should.eql [ 1, 'what', new Date( 81, 8, 4 )]
      target.should.eql
        '0' : 1,
        '1' : 'what',
        '2' : new Date( 81, 8, 4 )

    it  'date', ->
      ori    = 'what u gonna say'
      target = extend ori, date 

      ori.should.eql 'what u gonna say' 
      date.should.eql new Date( 81, 4, 13 )
      target.should.eql new Date( 81, 4, 13 )

    it 'object', ->
      ori    = 'what u gonna say'
      target = extend ori, obj 

      ori.should.eql 'what u gonna say'
      obj.should.eql
        str : 'me a test',
        int : 10,
        arr : [ 1, 'what', new Date( 81, 8, 4 )],
        date : new Date( 81, 4, 13 )

      target.should.eql
        str : 'me a test',
        int : 10,
        arr : [ 1, 'what', new Date( 81, 8, 4 )],
        date : new Date( 81, 4, 13 )

  describe 'should merge number with:', ->

    it 'string', ->
      ori    = 20
      target = extend ori, str 

      ori.should.eql 20 
      str.should.eql 'me a test' 
      target.should.eql
        '0' : 'm',
        '1' : 'e',
        '2' : ' ',
        '3' : 'a',
        '4' : ' ',
        '5' : 't',
        '6' : 'e',
        '7' : 's',
        '8' : 't'

    it 'number', ->
      ori    = 20
      target = extend ori, int 

      ori.should.eql 20 
      int.should.eql 10 
      target.should.eql {}

    it 'array', ->
      ori    = 20
      target = extend ori, arr

      ori.should.eql 20 
      arr.should.eql [ 1, 'what', new Date( 81, 8, 4 )]
      target.should.eql
        '0' : 1,
        '1' : 'what',
        '2' : new Date( 81, 8, 4 )

    it 'date', ->
      ori    = 20
      target = extend ori, date 

      ori.should.eql 20 
      date.should.eql new Date( 81, 4, 13 )
      target.should.eql new Date( 81, 4, 13 )

    it 'object', ->
      ori    = 20
      target = extend ori, obj

      ori.should.eql 20
      obj.should.eql
        str : 'me a test',
        int : 10,
        arr : [ 1, 'what', new Date( 81, 8, 4 )],
        date : new Date( 81, 4, 13 )

   